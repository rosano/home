{{ define "main" }}

{{- $pages := .Scratch.Get "rss-pages" }}

{{- range $pages }}

<item>
  <title>{{ or .Title (.Date.Format "Monday, January 2, 2006 15h04") }}</title>
  <link>{{ .Permalink }}</link>
  <pubDate>{{ .Date.Format "Mon, 02 Jan 2006 15:04:05 -0700" | safeHTML }}</pubDate>
  <guid>{{ .Permalink }}</guid>
  <description>{{ .Summary | transform.Plainify | transform.XMLEscape | safeHTML }}</description>
  <content:encoded>{{ printf "<![CDATA[" | safeHTML }}
    
  {{- with .Params.youtube_id }}
<iframe width="300" height="250" src="https://www.youtube-nocookie.com/embed/{{ . }}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  {{ end -}}

  <!-- NUGGET -->
  {{- if .Params.Summary -}}
    <div class="nugget">{{ .Summary | markdownify | safeHTML }}</div>
  {{- end -}}

  <!-- CONTENT -->
  {{ .Content | safeHTML }}

  {{- printf "]]>" | safeHTML }}</content:encoded>
</item>

{{- end }}

{{ end }}
